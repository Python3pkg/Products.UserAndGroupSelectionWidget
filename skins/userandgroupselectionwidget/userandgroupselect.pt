<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="atmemberselectwidget">
   <head><title></title></head>
   <body>

     <metal:view_macro define-macro="view" 
                       tal:define="value accessor;
                                   multiVal field/multiValued;">                                   
       <tal:single tal:condition="not:multiVal">
          <tal:block tal:define="minfo python:mtool.getMemberInfo(value);
                                   home python:mtool.getHomeFolder(value);">
               <a href="" tal:attributes="href home/absolute_url | nothing" tal:omit-tag="not:widget/link_to_home">
                 <tal:fullname tal:condition="widget/show_fullname"
                   ><tal:block tal:define="fullname minfo/fullname"
                               tal:content="fullname | value"
                    /></tal:fullname>
                 <tal:notfullname tal:condition="not:widget/show_fullname">
                      <span tal:content="value"/>
                 </tal:notfullname>
               </a>  
          </tal:block>
       </tal:single>
       <tal:multival tal:condition="multiVal">
           <tal:users tal:repeat="username value">  
             <tal:user tal:define="minfo python:mtool.getMemberInfo(username);
                                   home python:mtool.getHomeFolder(username);">
               <a href="" tal:attributes="href home/absolute_url | nothing" tal:omit-tag="not:widget/link_to_home">
                 <tal:fullname tal:condition="widget/show_fullname"
                   ><tal:block tal:define="fullname minfo/fullname"
                               tal:content="fullname | username"
                    /></tal:fullname>
                 <tal:notfullname tal:condition="not:widget/show_fullname">
                      <span tal:content="username"/>
                 </tal:notfullname>
               </a><br />
             </tal:user>
           </tal:users>  
       </tal:multival>
     </metal:view_macro>

     <metal:edit_macro define-macro="edit">
       <metal:use use-macro="field_macro | here/widgets/field/macros/edit">

          <div metal:fill-slot="widget_body"
               tal:define="multiVal python:test(field.multiValued, 1, 0); 
                           field_required field/required;
                           fieldId fieldId | fieldName;
                           size widget/size | nothing;
                           groupName widget/groupName;">
          </div> 
       </metal:use>
     </metal:edit_macro>

   </body>
</html>
